<?php

$d8_nodes[98] = array(
  array(

    "field_related_document"=>8671,
  ),
  array(

    "field_related_document"=>402,
  ),
);

$d8_nodes[100] = array(
  array(

    "field_related_link"=>array(
      "uri"=>"https://www.ipu.org/sites/default/files/documents/statutes_-_april_2017-final-e.pdf#page=37",
      "title"=>"Terms of reference of the Sub-Committee on Finance",
    ),
  ),
  array(

    "field_related_document"=>402,
  ),
);

$d8_nodes[197] = array(
  array(

    "field_related_document"=>402,
  ),
  array(

    "field_related_link"=>array(
      "uri"=>"https://beta.ipu.org/sites/default/files/documents/statutes_-_april_2017-final-e.pdf#page=84",
      "title"=>"Rules of the Secretariat",
    ),
  ),
);

$d8_nodes[198] = array(
  array(

    "field_related_document"=>9684,
  ),
  array(

    "field_related_document"=>8817,
  ),
  array(

    "field_related_document"=>8816,
  ),
  array(

    "field_related_document"=>8815,
  ),
  array(

    "field_related_document"=>9232,
  ),
  array(

    "field_related_document"=>9234,
  ),
  array(

    "field_related_document"=>9235,
  ),
  array(

    "field_related_document"=>9458,
  ),
  array(

    "field_related_document"=>9238,
  ),
  array(

    "field_related_document"=>9237,
  ),
  array(

    "field_related_document"=>9236,
  ),
);

$d8_nodes[200] = array(
  array(

    "field_related_link"=>array(
      "uri"=>"sites/default/files/documents/statutes_-_april_2017-final-e.pdf#page=40",
      "title"=>"Rules of the Standing Committees",
    ),
  ),
  array(

    "field_related_document"=>402,
  ),
);

$d8_nodes[201] = array(
  array(

    "field_related_link"=>array(
      "uri"=>"sites/default/files/documents/statutes_-_april_2017-final-e.pdf#page=40",
      "title"=>"Rules of the Standing Committees",
    ),
  ),
  array(

    "field_related_document"=>402,
  ),
);

$d8_nodes[202] = array(
  array(

    "field_related_link"=>array(
      "uri"=>"sites/default/files/documents/statutes_-_april_2017-final-e.pdf#page=40",
      "title"=>"Rules of the Standing Committees",
    ),
  ),
  array(

    "field_related_document"=>402,
  ),
);

$d8_nodes[203] = array(
  array(

    "field_related_link"=>array(
      "uri"=>"sites/default/files/documents/statutes_-_april_2017-final-e.pdf#page=40",
      "title"=>"Rules of the Standing Committees",
    ),
  ),
  array(

    "field_related_document"=>402,
  ),
);

$d8_nodes[205] = array(
  array(

    "field_related_link"=>array(
      "uri"=>"http://archive.ipu.org/strct-e/hrcmt-new.htm",
      "title"=>"Rules and Practices of the Committee on the Human Rights of Parliamentarians",
    ),
  ),
  array(

    "field_related_document"=>402,
  ),
  array(

    "field_related_document"=>8640,
  ),
);

$d8_nodes[206] = array(
  array(

    "field_related_link"=>array(
      "uri"=>"http://archive.ipu.org/cnl-e/193/g-mainstream.pdf",
      "title"=>"Gender mainstreaming at the IPU",
    ),
  ),
  array(

    "field_related_link"=>array(
      "uri"=>"https://www.ipu.org/sites/default/files/documents/pursuing_gender_parity_on_panels.pdf",
      "title"=>"Pursuing gender parity on panels: The Secretary General\'s guidelines",
    ),
  ),
);

$d8_nodes[207] = array(
  array(

    "field_related_link"=>array(
      "uri"=>"http://archive.ipu.org/cnl-e/193/g-mainstream.pdf",
      "title"=>"Gender mainstreaming at the IPU",
    ),
  ),
  array(

    "field_related_link"=>array(
      "uri"=>"https://www.ipu.org/sites/default/files/documents/pursuing_gender_parity_on_panels.pdf",
      "title"=>"Pursuing gender parity on panels: Guidance Note by the IPU Secretary General",
    ),
  ),
);

$d8_nodes[209] = array(
  array(

    "field_related_document"=>402,
  ),
);

$d8_nodes[210] = array(
  array(

    "field_related_document"=>8609,
  ),
  array(

    "field_related_document"=>402,
  ),
);

$d8_nodes[214] = array(
  array(

    "field_related_link"=>array(
      "uri"=>"http://w3.ipu.org/registration/doc/Online%20reg%20note-generic-a.pdf",
      "title"=>"How to use the IPU Assembly Registration System",
    ),
  ),
);

$d8_nodes[215] = array(
  array(

    "field_related_link"=>array(
      "uri"=>"https://www.ipu.org/sites/default/files/documents/statutes_-_april_2017-final-e.pdf#page=40",
      "title"=>"Rules of the Standing Committees",
    ),
  ),
);

$d8_nodes[216] = array(
  array(

    "field_related_link"=>array(
      "uri"=>"https://www.ipu.org/sites/default/files/documents/statutes_-_april_2017-final-e.pdf#page=50",
      "title"=>"Rules of the Forum of Women Parliamentarians",
    ),
  ),
  array(

    "field_related_document"=>402,
  ),
);

$d8_nodes[217] = array(
  array(

    "field_related_link"=>array(
      "uri"=>"https://www.ipu.org/sites/default/files/documents/statutes_-_april_2017-final-e.pdf#page=60",
      "title"=>"Rules of the Bureau of Women Parliamentarians",
    ),
  ),
  array(

    "field_related_document"=>402,
  ),
);

$d8_nodes[218] = array(
  array(

    "field_related_document"=>8535,
  ),
  array(

    "field_related_document"=>402,
  ),
);

$d8_nodes[221] = array(
  array(

    "field_related_link"=>array(
      "uri"=>"https://www.ipu.org/resources/publications/handbooks/2016-07/handbook-internal-displacement-responsibility-and-action",
      "title"=>"Handbook: Internal Displacement: Responsibility and Action",
    ),
  ),
  array(

    "field_related_link"=>array(
      "uri"=>"https://www.ipu.org/resources/publications/handbooks/2016-07/handbook-parliamentarians-refugee-protection-guide-international-refugee-law",
      "title"=>"Handbook: Refugee protection: A Guide to International Refugee Law",
    ),
  ),
);

$d8_nodes[222] = array(
  array(

    "field_related_document"=>402,
  ),
);

$d8_nodes[223] = array(
  array(

    "field_related_document"=>402,
    "field_related_document"=>336,
  ),
  array(

    "field_related_link"=>array(
      "uri"=>"http://archive.ipu.org/strct-e/obsrv-new.htm",
      "title"=>"Modalities of the rights and responsibilities of IPU Observers",
    ),
  ),
);

$d8_nodes[396] = array(
  array(

    "field_related_link"=>array(
      "uri"=>"https://www.ipu.org/sites/default/files/documents/statutes_-_april_2017-final-e.pdf#page=64",
      "title"=>"Rules and working modalities of the Forum of Young Parliamentarians",
    ),
  ),
  array(

    "field_related_document"=>402,
  ),
);

$d8_nodes[8292] = array(
  array(

    "field_related_document"=>8020,
  ),
);

$d8_nodes[8293] = array(
  array(

    "field_related_link"=>array(
      "uri"=>"sites/default/files/documents/statutes-e.pdf#page=60",
      "title"=>"this is a link to internal doc",
    ),
  ),
);

$d8_nodes[8350] = array(
  array(

    "field_related_document"=>9474,
  ),
);

$d8_nodes[8352] = array(
  array(

    "field_related_document"=>9459,
  ),
  array(

    "field_related_document"=>9463,
  ),
);

$d8_nodes[8353] = array(
  array(

    "field_related_document"=>9530,
  ),
);

$d8_nodes[8358] = array(
  array(

    "field_related_link"=>array(
      "uri"=>"http://archive.ipu.org/conf-e/130/Res-1.htm",
      "title"=>"Towards a Nuclear-Weapon-Free World: The Contribution of Parliaments: Resolution adopted by the 130th IPU Assembly",
    ),
  ),
  array(

    "field_related_link"=>array(
      "uri"=>"http://archive.ipu.org/splz-e/civ1540/1540.pdf",
      "title"=>"United Nations Security Council Resolution 1540",
    ),
  ),
  array(

    "field_related_link"=>array(
      "uri"=>"https://www.ctbto.org/the-treaty/",
      "title"=>"Comprehensive Nuclear-Test-Ban-Treaty",
    ),
  ),
);

$d8_nodes[8372] = array(
  array(

    "field_related_document"=>8695,
  ),
);

$d8_nodes[8377] = array(
  array(

    "field_related_document"=>8418,
  ),
  array(

    "field_related_document"=>9465,
  ),
);

$d8_nodes[8416] = array(
  array(

    "field_related_document"=>8796,
  ),
  array(

    "field_related_document"=>8797,
  ),
);

$d8_nodes[8516] = array(
  array(

    "field_related_document"=>9530,
  ),
);

$d8_nodes[8656] = array(
  array(

    "field_related_link"=>array(
      "uri"=>"https://www.ipu.org/sites/default/files/documents/pursuing_gender_parity_on_panels.pdf",
      "title"=>"Pursuing gender parity on panels: Guidance Note by the IPU Secretary General",
    ),
  ),
);

$d8_nodes[9526] = array(
  array(

    "field_related_document"=>9536,
  ),
  array(

    "field_related_document"=>9535,
  ),
  array(

    "field_related_document"=>9537,
  ),
);

$d8_nodes[9774] = array(
  array(

    "field_related_link"=>array(
      "uri"=>"https://www.ipu.org/resources/publications/reports/2018-11/world-e-parliament-report-2018",
      "title"=>"World e-Parliament Report 2018",
    ),
  ),
  array(

    "field_related_link"=>array(
      "uri"=>"https://www.ipu.org/resources/publications/reports/2016-07/world-e-parliament-report-2016",
      "title"=>"World e-Parliament Report 2016",
    ),
  ),
  array(

    "field_related_link"=>array(
      "uri"=>"https://www.ipu.org/resources/publications/reports/2016-07/world-e-parliament-report-2012",
      "title"=>"World e-Parliament Report 2012",
    ),
  ),
  array(

    "field_related_link"=>array(
      "uri"=>"https://www.ipu.org/resources/publications/reports/2016-07/world-e-parliament-report-2010",
      "title"=>"World e-Parliament Report 2010",
    ),
  ),
  array(

    "field_related_link"=>array(
      "uri"=>"https://www.ipu.org/resources/publications/reports/2016-07/world-e-parliament-report-2008",
      "title"=>"World e-Parliament Report 2008",
    ),
  ),
  array(

    "field_related_link"=>array(
      "uri"=>"https://www.ipu.org/resources/publications/reports/2016-07/report-world-e-parliament-conference",
      "title"=>"Report of the World e-Parliament Conference",
    ),
  ),
);

use Drupal\paragraphs\Entity\Paragraph;  // Don't forget to use a little Class...

$counter = 0;

foreach($d8_nodes as $node_id=>$new_paragraphs) {
  //  print "\n $k";
  //  print "\n";
  //  debug($v);

  $node = entity_load('node', $node_id);

  foreach($new_paragraphs as $new_paragraph) {
    $paragraph = Paragraph::create(['type' => 'related_documents',]);

    if (!empty($new_paragraph['field_related_document'])) {
      $paragraph->set('field_related_document', ['target_id' => htmlspecialchars_decode($new_paragraph['field_related_document'])]);
    }

    if (!empty($new_paragraph['field_related_link'])) {
      $paragraph->set('field_external_link',
        ["uri" => htmlspecialchars_decode($new_paragraph['field_related_link']['uri']),
          "title" => htmlspecialchars_decode($new_paragraph['field_related_link']['title']),
        ]
      );

     # debug($new_paragraph['field_related_link']['title']);
    }
    debug($new_paragraph);
    $node->field_related_documents->appendItem($paragraph);
    //$node->set('field_publication_document', []); // remove all paras from this node
    $counter++;
  }


  $node->save();
  print("\n - saved node $node_id \n");
  #print_r($new_paragraph);

  // Grab any existing paragraphs from the node, and add this one
  //  $current = $node->get('NODE_FIELD_NAME')->getValue();
  //  $current[] = array(
  //    'target_id' => $paragraph->id(),
  //    'target_revision_id' => $paragraph->getRevisionId(),
  //  );
  //  $node->set('NODE_FIELD_NAME', $current);
  //  $node->save();

}

print("\n - saved $counter paragraphs");
